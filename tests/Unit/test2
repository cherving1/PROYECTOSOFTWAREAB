<?php
namespace Tests\Unit;

use Tests\TestCase;
use App\Models\Proyecto;
use Illuminate\Foundation\Testing\RefreshDatabase;

class ProyectoTest extends TestCase
{
    use RefreshDatabase; // Para asegurarte de que la base de datos esté en un estado limpio

    /** @test */
    public function it_can_create_a_proyecto()
    {
        // Crear un nuevo proyecto utilizando asignación masiva
        $proyecto = Proyecto::create([
            'nombreProyecto' => 'Nuevo Proyecto',
            'descripcionProyecto' => 'Descripción del nuevo proyecto',
            'responsable' => 'Juan Pérez',
            'fechaInicio' => '2024-01-01',
            'fechaFin' => '2024-12-31',
        ]);

        // Verifica que el proyecto se haya creado en la base de datos
        $this->assertDatabaseHas('proyectos', [
            'nombreProyecto' => 'Nuevo Proyecto',
            'responsable' => 'Juan Pérez',
        ]);

        // Verifica que los otros campos se establecieron correctamente
        $this->assertEquals('Descripción del nuevo proyecto', $proyecto->descripcionProyecto);
        $this->assertEquals('2024-01-01', $proyecto->fechaInicio);
        $this->assertEquals('2024-12-31', $proyecto->fechaFin);
    }

    /** @test */
    public function it_has_correct_fillable_attributes()
    {
        // Verifica que los atributos fillable sean correctos
        $expectedFillable = [
            'nombreProyecto',
            'descripcionProyecto',
            'responsable',
            'fechaInicio',
            'fechaFin',
        ];
        $this->assertEquals($expectedFillable, (new Proyecto)->getFillable());
    }

    /** @test */
    public function it_has_correct_primary_key()
    {
        // Verifica que la clave primaria sea la correcta
        $this->assertEquals('idProyecto', (new Proyecto)->getKeyName());
    }

    /** @test */
    public function it_can_set_and_get_attributes()
    {
        // Crear un nuevo proyecto
        $proyecto = new Proyecto();

        // Establece los atributos
        $proyecto->nombreProyecto = 'Proyecto Test';
        $proyecto->descripcionProyecto = 'Descripción del proyecto de prueba';
        $proyecto->responsable = 'Ana Gómez';
        $proyecto->fechaInicio = '2024-02-01';
        $proyecto->fechaFin = '2024-11-30';

        // Verifica que los atributos se establecen correctamente
        $this->assertEquals('Proyecto Test', $proyecto->nombreProyecto);
        $this->assertEquals('Descripción del proyecto de prueba', $proyecto->descripcionProyecto);
        $this->assertEquals('Ana Gómez', $proyecto->responsable);
        $this->assertEquals('2024-02-01', $proyecto->fechaInicio);
        $this->assertEquals('2024-11-30', $proyecto->fechaFin);
    }
}
